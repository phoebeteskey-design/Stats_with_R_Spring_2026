---
title: "Problems ENVS567"
author: "Phoebe Teskey"
date: "2026-01-22"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

*Problem #1*

1. Under highly favorable conditions, populations grow exponentially. However resources will eventually limit population growth and exponential growth cannot continue indefinitely. This phenomenon is described by the logistic growth function:

N_t=(KN_0)/〖N_0+(K-N_0)e〗^(-rt) 

where Nt is the population size at time t, N0 is the initial population size, r is the rate of growth or reproductive rate, and K is the carrying capacity.

Write a logistic growth function in R that also generates a plot with time on the x axis and Nt on the y axis. Using that function create 3 separate plots for 20 days assuming an initial population size of 10 individuals and a carrying capacity of 1,000 individuals under 3 growth rate scenarios (0.5, 0.8, 0.4).
Plot the previous results (that is, 3 growth rate scenarios) in a single plot using ggplot2.

```{r}
install.packages("ggplot2")
library(ggplot2)

logistic_growth <- function(pop_size) {
  pop_size <- (KN_0)/(N_0+(K-N_0)e)^(-rt)
  return(pop_size)
}
```

*Problem #2*

a)	A function (sum_n) that for any given value, say n, computes the sum of the integers from 1 to n (inclusive). Use the function to determine the sum of integers from 1 to 5,000.


```{r}
n <- 1:5000

sum_n <- function(n){
  sum <- sum(1:length(n))
  return(sum)
}

sum_n(n)

```
b)	A function (sqrt_round) that takes a number x as input, takes the square root, rounds it to the nearest whole number and then returns the result.

```{r}
sqrt_round <- function(x) {
  sqrt <- x^(1/2)
  rounded <- round(sqrt)
  return(rounded)
}

sqrt_round(13)
```

*Review of Statistics*

The data in the file DesertBirdAbundance.csv are from a survey of the breeding birds of Organ Pipe Cactus National Monument in southern Arizona.

*Problem 1*:	Draw a histogram of the data.

```{r}
library(ggplot2)
birds <- read.csv("data_raw/DesertBirdAbundance.csv")
str(birds)
birds_plot <- ggplot(birds, aes(x = species, y= abundance))+
  geom_col()+
  coord_flip()
plot(birds_plot)
```

Calculate the median and the mean. In this particular case, which do you think is the best measure of center, the mean or the median? Why?

```{r}
mean(birds$abundance)
median(birds$abundance)
```

In this case, the median is a more accurate representation of the data because we have outliers like the white-winged dove that was seen over 600 times. 

*Problem 2*: Normal human body temperature is 98.6 ºF. Researchers obtained body-temperature measurements on randomly chosen healthy people: 98.4, 98.6, 97.8, 98.8, 97.9, 99.0, 98.2, 98.8, 98.8, 99.0, 98.0, 99.2, 99.5, 99.4, 98.4, 99.1, 98.4, 97.6, 97.4, 97.5, 97.5, 98.8, 98.6, 100.0, 98.4.

a)	Draw a histogram of the data.

```{r}
healthy_temps <- c(98.4, 98.6, 97.8, 98.8, 97.9, 99.0, 98.2, 98.8, 98.8, 99.0, 98.0, 99.2, 99.5, 99.4, 98.4, 99.1, 98.4, 97.6, 97.4, 97.5, 97.5, 98.8, 98.6, 100.0, 98.4)

plot(healthy_temps)
```


b)	Are these measurements consistent with a population mean of 98.6 ºF?
The mean is close to 98.6 but not exact at 98.5

```{r}
mean(healthy_temps)
```

The mean is close to 98.6 but not exact at 98.5

*Problem 3*: The brown recluse spider often lives in houses throughout central North America. A diet-preference study gave each of 41 spiders a choice between two crickets, one live and one dead. 31 of the 41 spiders chose the dead cricket over the live one. Does this represent evidence for a diet preference?

```{r}
binom.test(31, 41, p = 0.5)
```

Yes, this is a significant result.

*Problem 4:* A bee biologist is analyzing whether there was an association between bee colony number and type of forest habitat. We expect that there is no habitat preference for bee colony number. Make a barplot of the data and assess if no habitat preference is true based on this data?

```{r}
tree <- c("oak", "hickory", "maple", "red cedar", "poplar")
bee_colonies <- c(33, 30, 29, 4, 4)
tree_bee <- data.frame(x = tree, y = bee_colonies)

ggplot(tree_bee, aes(x = tree, y = bee_colonies))+
  geom_col()
```

There clearly seems to be a habitat preference for oak, maple and hickory trees.

*Problem 5:* You are hired by the US Department of Agriculture to develop effective control practices for invasive plants (data_ANOVA.xlsx). In particular, you are asked to investigate pesticide controls for kudzu which is an invasive vine that grows in thick mats that smother underlying plants. Two of the most widely used pesticides for kudzu are glyphosate and triclopyr. To determine the effectiveness of a single application of pesticide, you conduct an experiment in 18 plots that each had 50% kudzu cover. In mid-summer, you applied equal amounts of 2% glyphosate to 6 plots, 2% triclopyr to 6 plots, and water without pesticides to 6 plots. Then you returned in autumn and measured the percent cover of kudzu in the plots.

a)	Transform the data from wide to long format.

```{r}
install.packages("reshape2")
library(reshape2)
kudzu <- read.csv("data_raw/data_ANOVA.csv")
kudzu_long <- melt(kudzu)
```

b)	Make a boxplot and perform an ANOVA.

```{r}
ggplot(kudzu_long, aes(x = variable, y = value))+
  geom_boxplot()
kudzu_anova <- aov(value~variable, kudzu_long)
summary(kudzu_anova)
```

This does not indicate a significant result.

*Problem 6:* Testosterone is known to predict aggressive behavior and is involved in face shape during puberty. Researchers measured the face width-to-height ratio of 21 university hockey players with the average number of penalty minutes awarded per game for aggressive infractions. The data are available in face.txt.

a)	Calculate the correlation coefficient.

```{r}
aggression <- read.table("data_raw/face.txt", header = T, sep = "\t")
cor(x = aggression$Face, y = aggression$Penalty)
```

b)	Does face shape predict aggression? Write the result in the form of an equation for the line.

```{r}
aggression_prediction <- lm(Penalty ~ Face, data = aggression)
summary(aggression_prediction)
```
y = 3.189x - 4.505

c)	What is the variation explained?

```{r}

```

d)	Make a scatterplot of the data and include the linear regression line in the plot.

```{r}
ggplot(aggression, aes(x = Face, y = Penalty))+
  geom_point()+
  geom_smooth(method = "lm", se = T)
```


*Linear (and non-linear) Models*

1. Data in growth.txt come from a farm-scale trial of animal diets. There are two factors: diet and supplement. Diet is a factor with three levels: barley, oats and wheat. Supplement is a factor with four levels: agrimore, control, supergain and supersupp. The response variable is weight gain after 6 weeks. Analyze the data following this structure: 1. Question, 2. Exploratory analyses, 3. Fit model, 4. Validate model, 5. Test hypothesis and assess explanatory power, and 6. Communication of results (plot + description of main results).

Question: What diet increases weight gain in mice?

```{r}
#Exploratory analyses
library(reshape2)
library(ggplot2)
growth <- read.table("data_raw/growth.txt", header = T)
```

